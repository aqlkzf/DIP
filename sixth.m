I=imread('lena.bmp');
H=fspecial('motion',50,45);
I1=imfilter(I,H,'circular','conv');
subplot(2,2,1);
imshow(I1);
subplot(2,2,2);
I2=imnoise(I1,'gaussian',0,0.01);
imshow(I2);
subplot(2,2,3);
noise=imnoise(zeros(size(I)),'gaussian',0,0.01);
NSR=sum(noise(:).^2/sum(im2double(I(:).^2)));
I3=deconvwnr(I2,H,NSR);
imshow(I3);
subplot(2,2,4);
NP=0.000003*numel(I);
[I4,~]=deconvreg(I1,H,NP);
imshow(I4);

imwrite(I1,"1.jpg")
imwrite(I2,"2.jpg")
imwrite(I3,"3.jpg")
imwrite(I4,"4.jpg")
